{"version":4,"terraform_version":"1.9.0","serial":5,"lineage":"24dc09ed-50b9-32e5-1e09-fb47c4c37fa9","outputs":{},"resources":[{"module":"module.opa-templates","mode":"managed","type":"kubernetes_manifest","name":"privileged_template","provider":"provider[\"registry.opentofu.org/hashicorp/kubernetes\"]","instances":[{"schema_version":1,"attributes":{"computed_fields":null,"field_manager":[],"manifest":{"value":{"apiVersion":"templates.gatekeeper.sh/v1beta1","kind":"ConstraintTemplate","metadata":{"name":"k8sdisallowprivileged"},"spec":{"crd":{"spec":{"names":{"kind":"K8sDisallowPrivileged"}}},"targets":[{"rego":"package k8sdisallowprivileged\n\nviolation[{\"msg\": msg}] {\n  container := input.review.object.spec.containers[_]\n  container.securityContext.privileged == true\n  msg := sprintf(\"Privileged container is not allowed: %s\", [container.name])\n}\n","target":"admission.k8s.gatekeeper.sh"}]}},"type":["object",{"apiVersion":"string","kind":"string","metadata":["object",{"name":"string"}],"spec":["object",{"crd":["object",{"spec":["object",{"names":["object",{"kind":"string"}]}]}],"targets":["tuple",[["object",{"rego":"string","target":"string"}]]]}]}]},"object":{"value":{"apiVersion":"templates.gatekeeper.sh/v1beta1","kind":"ConstraintTemplate","metadata":{"annotations":null,"creationTimestamp":null,"deletionGracePeriodSeconds":null,"deletionTimestamp":null,"finalizers":null,"generateName":null,"generation":null,"labels":null,"managedFields":null,"name":"k8sdisallowprivileged","namespace":null,"ownerReferences":null,"resourceVersion":null,"selfLink":null,"uid":null},"spec":{"crd":{"spec":{"names":{"kind":"K8sDisallowPrivileged","shortNames":null},"validation":{"legacySchema":true,"openAPIV3Schema":null}}},"targets":[{"code":null,"libs":null,"rego":"package k8sdisallowprivileged\n\nviolation[{\"msg\": msg}] {\n  container := input.review.object.spec.containers[_]\n  container.securityContext.privileged == true\n  msg := sprintf(\"Privileged container is not allowed: %s\", [container.name])\n}\n","target":"admission.k8s.gatekeeper.sh"}]}},"type":["object",{"apiVersion":"string","kind":"string","metadata":["object",{"annotations":["map","string"],"creationTimestamp":"string","deletionGracePeriodSeconds":"number","deletionTimestamp":"string","finalizers":["list","string"],"generateName":"string","generation":"number","labels":["map","string"],"managedFields":["tuple",[["object",{"apiVersion":"string","fieldsType":"string","fieldsV1":"dynamic","manager":"string","operation":"string","subresource":"string","time":"string"}]]],"name":"string","namespace":"string","ownerReferences":["list",["object",{"apiVersion":"string","blockOwnerDeletion":"bool","controller":"bool","kind":"string","name":"string","uid":"string"}]],"resourceVersion":"string","selfLink":"string","uid":"string"}],"spec":["object",{"crd":["object",{"spec":["object",{"names":["object",{"kind":"string","shortNames":["list","string"]}],"validation":["object",{"legacySchema":"bool","openAPIV3Schema":"dynamic"}]}]}],"targets":["tuple",[["object",{"code":["tuple",[["object",{"engine":"string","source":"dynamic"}]]],"libs":["list","string"],"rego":"string","target":"string"}]]]}]}]},"timeouts":[],"wait":[],"wait_for":null},"sensitive_attributes":[],"dependencies":["module.open-policy-agent.helm_release.open-policy-agent"]}]},{"module":"module.open-policy-agent","mode":"managed","type":"helm_release","name":"open-policy-agent","provider":"provider[\"registry.opentofu.org/hashicorp/helm\"]","instances":[{"schema_version":1,"attributes":{"atomic":false,"chart":"gatekeeper","cleanup_on_fail":false,"create_namespace":true,"dependency_update":false,"description":null,"devel":null,"disable_crd_hooks":false,"disable_openapi_validation":false,"disable_webhooks":false,"force_update":false,"id":"opa","keyring":null,"lint":false,"manifest":null,"max_history":0,"metadata":[{"app_version":"v3.18.2","chart":"gatekeeper","first_deployed":1743937859,"last_deployed":1743937859,"name":"opa","namespace":"open-policy-agent","notes":"","revision":1,"values":"{}","version":"3.18.2"}],"name":"opa","namespace":"open-policy-agent","pass_credentials":false,"postrender":[],"recreate_pods":false,"render_subchart_notes":true,"replace":false,"repository":"https://open-policy-agent.github.io/gatekeeper/charts","repository_ca_file":null,"repository_cert_file":null,"repository_key_file":null,"repository_password":null,"repository_username":null,"reset_values":false,"reuse_values":false,"set":[],"set_list":[],"set_sensitive":[],"skip_crds":false,"status":"deployed","timeout":300,"upgrade_install":null,"values":null,"verify":false,"version":"3.18.2","wait":true,"wait_for_jobs":false},"sensitive_attributes":[[{"type":"get_attr","value":"repository_password"}]],"private":"eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="}]}],"check_results":null}
